language: cpp

dist: trusty
sudo: required
os: linux
  
compiler: 
  - gcc
  - clang
  
env:
  - BUILD_TYPE=release
  
cache:
  apt: true
  directories:
    - $HOME/.cache/pip
    - $HOME/.cache/http
    - /home/travis/.cache/pip
    - /home/travis/.cache/pip/http

branches:
  only:
    - master
    - develop

before_install:
  - sudo sh .travis/${TRAVIS_OS_NAME}/before_install.sh
  - sudo sh .travis/${TRAVIS_OS_NAME}/${CC}/before_install.sh
 
install:
  - source .travis/${TRAVIS_OS_NAME}/install.sh
  - source .travis/${TRAVIS_OS_NAME}/${CC}/install.sh
   
script:
  - nproc
  - ${CXX} --version
  - cd qtreportslib
  - qmake -spec ${USING_QT_MKSPEC} "CONFIG+= ${BUILD_TYPE}" qtreportslib.pro
  - make
  - sudo make install
  - cd ../qtreportsviewer
  - qmake -spec ${USING_QT_MKSPEC} qtreportsviewer.pro
  - make
  - cd ../qtreportslib_tests
  - qmake -spec ${USING_QT_MKSPEC} "CONFIG+= ${BUILD_TYPE}" qtreportslib_tests.pro
  - make
  - ./qtreportslib_tests
